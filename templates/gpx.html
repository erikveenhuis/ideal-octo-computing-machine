{% extends "base.html" %}

{% block title %}GPX Route Viewer{% endblock %}

{% block extra_head %}
<link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/pica@9.0.1/dist/pica.min.js"></script>
{% include 'components/gpx_styles.html' %}
{% endblock %}

{% block content %}
{% include 'components/mobile_message.html' %}

<div class="hidden lg:block relative h-[calc(100vh-4rem)] overflow-hidden -mx-4 -my-6 sm:-mx-6 md:-mx-8 lg:-mx-12">
    {% include 'components/gpx_sidebar.html' %}
    {% include 'components/gpx_map_container.html' %}
</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
<script src="{{ url_for('static', filename='js/gpx-config.js') }}"></script>
<script src="{{ url_for('static', filename='js/gpx-utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/gpx-map-manager.js') }}"></script>
<script src="{{ url_for('static', filename='js/gpx-export-manager.js') }}"></script>
<script src="{{ url_for('static', filename='js/gpx-app.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize the GPX application with proper template variables
    const mapboxAccessToken = '{{ config.MAPBOX_ACCESS_TOKEN }}';
    const csrfToken = '{{ csrf_token() }}';
    
    // Create the app instance
    window.gpxApp = new GPXApp(mapboxAccessToken, csrfToken);
});
</script>
{% endblock %} 